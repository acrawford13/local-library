# coding=utf-8

from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from models import Base, User, Book
from datetime import datetime, timedelta
from random import randint

engine = create_engine('sqlite:///catalog.db')
Base.metadata.bind = engine

DBSession = sessionmaker(bind=engine)
session = DBSession()

def randomDate():
    now = datetime.now()
    interval = randint(0, 259200)
    date_added = now - timedelta(seconds = interval)
    return date_added

if __name__ == '__main__':
    session.query(User).delete()
    session.commit()

    session.query(Book).delete()
    session.commit()

    franny = User(name='Franny Glass', email='franny@glassfamily.com', picture='franny.jpg', username='franny-glass',location_lat=-33.811901,location_lng=151.003446,city='Paramatta, NSW',country='Australia')
    zooey = User(name='Zooey Glass', email='zooey@glassfamily.com', picture='zooey.jpg', username='zooey-glass',location_lat=-34.065034,location_lng=151.014986,city='Engadine, NSW',country='Australia')
    walt = User(name='Walt Glass', email='walt@glassfamily.com', picture='walt.jpg', username='walt-glass',location_lat=-33.965103,location_lng=151.135810,city='Kogarah, Sydney',country='Australia')
    waker = User(name='Waker Glass', email='waker@glassfamily.com', picture='waker.jpg', username='waker-glass',location_lat=-33.986912,location_lng=151.232899,city='La Perouse, Sydney',country='Australia')
    seymour = User(name='Seymour Glass', email='seymour@glassfamily.com', picture='seymour.jpg', username='seymour-glass',location_lat=-33.959358,location_lng=151.098833,city='Hurstville, Sydney',country='Australia')
    booboo = User(name='Beatrice Tannenbaum', email='booboo@glassfamily.com', picture='booboo.jpg', username='beatrice-tannenbaum',location_lat=-33.900471,location_lng=151.173289,city='Newtown, Sydney',country='Australia')
    buddy = User(name='Buddy Glass', email='buddy@glassfamily.com', picture='buddy.jpg', username='buddy-glass',location_lat=-33.883170,location_lng=151.200544,city='Ultimo, Sydney',country='Australia')

    session.add(franny)
    session.add(zooey)
    session.add(walt)
    session.add(waker)
    session.add(seymour)
    session.add(booboo)
    session.add(buddy)
    session.commit()

    book1 = Book(name='The Wind-Up Bird Chronicle', slug='the-wind-up-bird-chronicle', author='Haruki Murakami', owner=franny, date_added=randomDate(), description=u'''Japan's most highly regarded novelist now vaults into the first ranks of international fiction writers with this heroically imaginative novel, which is at once a detective story, an account of a disintegrating marriage, and an excavation of the buried secrets of World War II.<br /><br />In a Tokyo suburb a young man named Toru Okada searches for his wife's missing cat. Soon he finds himself looking for his wife as well in a netherworld that lies beneath the placid surface of Tokyo. As these searches intersect, Okada encounters a bizarre group of allies and antagonists: a psychic prostitute; a malevolent yet mediagenic politician; a cheerfully morbid sixteen-year-old-girl; and an aging war veteran who has been permanently changed by the hideous things he witnessed during Japan's forgotten campaign in Manchuria.<br /><br />Gripping, prophetic, suffused with comedy and menace, <i>The Wind-Up Bird Chronicle</i> is a tour de force equal in scope to the masterpieces of Mishima and Pynchon.<br /><br />Three books in one volume: The Thieving Magpie, Bird as Prophet, The Birdcatcher. This translation by Jay Rubin is in collaboration with the author.''')
    book2 = Book(name='Great House', slug='great-house', author='Nicole Krauss', owner=franny, date_added=randomDate(), description=u'''A powerful, soaring novel about a stolen desk that contains the secrets, and becomes the obsession, of the lives it passes through. <br /><br />For twenty-five years, a solitary American novelist has been writing at the desk she inherited from a young poet who disappeared at the hands of Pinochet's secret police; one day a girl claiming to be his daughter arrives to take it away, sending her life reeling. Across the ocean in London, a man discovers a terrifying secret about his wife of almost fifty years. In Jerusalem, an antiques dealer is slowly reassembling his father's Budapest study, plundered by the Nazis in 1944.<br /><br />These worlds are anchored by a desk of enormous dimension and many drawers that exerts a power over those who possess it or give it away. In the minds of those it has belonged to, the desk comes to stand for all that has disappeared in the chaos of the world-children, parents, whole peoples and civilizations. Nicole Krauss has written a hauntingly powerful novel about memory struggling to create a meaningful permanence in the face of inevitable loss.''')
    book3 = Book(name='Slaughterhouse-Five', slug='slaughterhouse-five', author='Kurt Vonnegut', owner=franny, date_added=randomDate(), description=u'''Kurt Vonnegut's absurdist classic <i>Slaughterhouse-Five</i> introduces us to Billy Pilgrim, a man who becomes unstuck in time after he is abducted by aliens from the planet Tralfamadore. In a plot-scrambling display of virtuosity, we follow Pilgrim simultaneously through all phases of his life, concentrating on his (and Vonnegut's) shattering experience as an American prisoner of war who witnesses the firebombing of Dresden.<br /><br />Don't let the ease of reading fool you - Vonnegut's isn't a conventional, or simple, novel. He writes, "There are almost no characters in this story, and almost no dramatic confrontations, because most of the people in it are so sick, and so much the listless playthings of enormous forces. One of the main effects of war, after all, is that people are discouraged from being characters."<br /><br /><i>Slaughterhouse-Five</i> is not only Vonnegut's most powerful book, it is also as important as any written since 1945. Like <i>Catch- 22</i>, it fashions the author's experiences in the Second World War into an eloquent and deeply funny plea against butchery in the service of authority. <i>Slaughterhouse-Five</i> boasts the same imagination, humanity, and gleeful appreciation of the absurd found in Vonnegut's other works, but the book's basis in rock-hard, tragic fact gives it a unique poignancy - and humor.''')
    book4 = Book(name='For Esme - with Love and Squalor', slug='for-esme-with-love-and-squalor', author='J.D. Salinger', owner=zooey, date_added=randomDate(), description=u'''"A Perfect Day for Bananafish" (1948)<br />"Uncle Wiggily in Connecticut" (1948)<br />"Just Before the War with the Eskimos" (1948)<br />"The Laughing Man" (1949)<br />"Down at the Dinghy" (1949)<br />"For Esmé – with Love and Squalor" (1950)<br />"Pretty Mouth and Green My Eyes" (1951)<br />"De Daumier-Smith's Blue Period" (1952)<br />"Teddy" (1953)''')
    book5 = Book(name='Terra Incognita', slug='terra-incognita', author='Vladimir Nabokov', owner=zooey, date_added=randomDate(), description=u'''These three stories of menace, magic and melancholy display Vladimir Nabokov's astonishing range and inventiveness. Whether describing an escape across a surreal tropical landscape, a fateful meeting or an unexpected - and threatening - return, each tale shows his dazzling sleight of hand, intellectual playfulness and fantastical imagination.<br /><br />This book includes <i>Terra Incognita</i>, <i>Spring in Fialta</i> and <i>The Doorbell</i>.''')
    book6 = Book(name='Less Than One', slug='less-than-one', author='Joseph Brodsky', owner=zooey, date_added=randomDate(), description=u'''This collection of essays thrusts Brodsky--heretofore known more for his poetry and translations--into the forefront of the "Third Wave" of Russian emigre writers. His insights into the works of Dostoyevsky, Mandelstam, Platonov, as well as non-Russian poets Auden, Cavafy and Montale are brilliant. While the Western popularity of many other Third Wavers has been stunted by their inability to write in English, Brodsky consumed the language to attain a "closer proximity" to poets such as Auden. The book, which won a National Book Critics Circle Award, opens and closes with revealing autobiographical essay.''')
    book7 = Book(name='Extremely Loud and Incredibly Close', slug='extremely-loud-and-incredibly-close', author='Jonathan Safran Foer', owner=walt, date_added=randomDate(), description=u'''Nine-year-old Oskar Schell is an inventor, amateur entomologist, Francophile, letter writer, pacifist, natural historian, percussionist, romantic, Great Explorer, jeweller, detective, vegan, and collector of butterflies. When his father is killed in the September 11th attacks on the World Trade Centre, Oskar sets out to solve the mystery of a key he discovers in his father's closet. It is a search which leads him into the lives of strangers, through the five boroughs of New York, into history, to the bombings of Dresden and Hiroshima, and on an inward journey which brings him ever closer to some kind of peace.''')
    book8 = Book(name='Laughable Loves', slug='laughable-loves', author='Milan Kundera', owner=walt, date_added=randomDate(), description=u'''<i>Laughable Loves</i> is a collection of stories that first appeared in print in Prague before 1968, but was then banned. The seven stories are all concerned with love, or rather with the complex erotic games and stratagems employed by women and especially men as they try to come to terms with needs and impulses that can start a terrifying train of events. Sexual attraction is shown as a game that often turns sour, an experience that brings with it painful insights and releases uncertainty, panic, vanity and a constant need for reassurance. Thus a young couple on holiday start a game of pretence that threatens to destroy their relationship, two middle-aged men go in search of girls they don't really want, a young man renews contact with an older woman who feels humiliated by her ageing body, an elderly doctor uses his beautiful wife to increase his attraction and minister to his sexual vanity. In <i>Laughable Loves</i>, Milan Kundera shows himself, once again, as a master of fiction's most graceful illusions and surprises.''')
    book9 = Book(name='Player Piano', slug='player-piano', author='Kurt Vonnegut', owner=walt, date_added=randomDate(), description=u'''Kurt Vonnegut’s first novel spins the chilling tale of engineer Paul Proteus, who must find a way to live in a world dominated by a supercomputer and run completely by machines. Paul’s rebellion is vintage Vonnegut—wildly funny, deadly serious, and terrifyingly close to reality.''')
    book10 = Book(name="Midnight's Children", slug='midnights-children', author='Salman Rushdie', owner=waker, date_added=randomDate(), description=u'''Born at the stroke of midnight, at the precise moment of India's independence, Saleem Sinai is destined from birth to be special. For he is one of 1,001 children born in the midnight hour, children who all have special gifts, children with whom Saleem is telepathically linked.<br /><br />But there has been a terrible mix up at birth, and Saleem’s life takes some unexpected twists and turns. As he grows up amidst a whirlwind of triumphs and disasters, Saleem must learn the ominous consequences of his gift, for the course of his life is inseparably linked to that of his motherland, and his every act is mirrored and magnified in the events that shape the newborn nation of India. It is a great gift, and a terrible burden.''')
    book11 = Book(name='Pale Fire', slug='pale-fire', author='Vladimir Nabokov', owner=waker, date_added=randomDate(), description=u'''<p>The urbane authority that Vladimir Nabokov brought to every word he ever wrote, and the ironic amusement he cultivated in response to being uprooted and politically exiled twice in his life, never found fuller expression than in Pale Fire published in 1962 after the critical and popular success of Lolita had made him an international literary figure.</p><p>An ingeniously constructed parody of detective fiction and learned commentary, Pale Fire offers a cornucopia of deceptive pleasures, at the center of which is a 999-line poem written by the literary genius John Shade just before his death. Surrounding the poem is a foreword and commentary by the demented scholar Charles Kinbote, who interweaves adoring literary analysis with the fantastical tale of an assassin from the land of Zembla in pursuit of a deposed king.</p><p>Brilliantly constructed and wildly inventive, this darkly witty novel of suspense, literary one-upmanship, and political intrigue achieves that rarest of things in literature: perfect tragicomic balance.</p>''')
    book12 = Book(name='All the Pretty Horses', slug='all-the-pretty-horses', author='Cormac McCarthy', owner=waker, date_added=randomDate(), description=u'''<i>All the Pretty Horses</i> tells of young John Grady Cole, the last of a long line of Texas ranchers. Across the border Mexico beckons—beautiful and desolate, rugged and cruelly civilized. With two companions, he sets off on an idyllic, sometimes comic adventure, to a place where dreams are paid for in blood.''')
    book13 = Book(name='Norwegian Wood', slug='norwegian-wood', author='Haruki Murakami', owner=buddy, date_added=randomDate(), description=u'''Toru, a quiet and preternaturally serious young college student in Tokyo, is devoted to Naoko, a beautiful and introspective young woman, but their mutual passion is marked by the tragic death of their best friend years before. Toru begins to adapt to campus life and the loneliness and isolation he faces there, but Naoko finds the pressures and responsibilities of life unbearable. As she retreats further into her own world, Toru finds himself reaching out to others and drawn to a fiercely independent and sexually liberated young woman.<br /><br />A poignant story of one college student's romantic coming-of-age, <b>Norwegian Wood</b> takes us to that distant place of a young man's first, hopeless, and heroic love.''')
    book14 = Book(name='Everything is Illuminated', slug='everything-is-illuminated', author='Jonathan Safran Foer', owner=buddy, date_added=randomDate(), description=u'''A young man arrives in the Ukraine, clutching in his hand a tattered photograph. He is searching for the woman who fifty years ago saved his grandfather from the Nazis. Unfortunately, however, he is aided in his quest by Alex, a translator with an uncanny ability to mangle English into new forms; a 'blind' old man haunted by memories of the war; and an undersexed guide dog named Sammy Davis, Jr, Jr. What they are looking for seems elusive - a truth hidden behind veils of time, language and the horrors of war. What they find turns all their worlds upside down...''')
    book15 = Book(name='How We Are Hungry', slug='how-we-are-hungry', author='Dave Eggers', owner=buddy, date_added=randomDate(), description=u'''<ul><li>"Another"</li><li>"What It Means When a Crowd in a Faraway Nation Takes a Soldier Representing Your Own Nation, Shoots Him, Drags Him from His Vehicle and Then Mutilates Him in the Dust"</li><li>"The Only Meaning of the Oil-Wet Water"</li><li>"On Wanting to Have Three Walls Up Before She Gets Home"</li><li>"Climbing to the Window, Pretending to Dance"</li><li>"She Waits, Seething, Blooming"</li><li>"Quiet"</li><li>"Your Mother and I"</li><li>"Naveed"</li><li>"Notes for a Story of a Man Who Will Not Die Alone"</li><li>"About the Man Who Began Flying After Meeting Her"</li><li>"Up the Mountain Coming Down Slowly"</li><li>"After I Was Thrown in the River and Before I Drowned"</li></ul>''')
    book16 = Book(name='A Heartbreaking Work of Staggering Genius', slug='a-heartbreaking-work-of-staggering-genius', author='Dave Eggers', owner=seymour, date_added=randomDate(), description=u'''Dave Eggers is a terrifically talented writer; don't hold his cleverness against him. What to make of a book called <i>A Heartbreaking Work of Staggering Genius: Based on a True Story</i>? For starters, there's a good bit of staggering genius before you even <i>get</i> to the true story, including a preface, a list of "Rules and Suggestions for Enjoyment of This Book," and a 20-page acknowledgements section complete with special mail-in offer, flow chart of the book's themes, and a lovely pen-and-ink drawing of a stapler (helpfully labeled "Here is a drawing of a stapler:").<p> But on to the true story. At the age of 22, Eggers became both an orphan and a "single mother" when his parents died within five months of one another of unrelated cancers. In the ensuing sibling division of labor, Dave is appointed unofficial guardian of his 8-year-old brother, Christopher. The two live together in semi-squalor, decaying food and sports equipment scattered about, while Eggers worries obsessively about child-welfare authorities, molesting babysitters, and his own health. His child-rearing strategy swings between making his brother's upbringing manically fun and performing bizarre developmental experiments on him. (Case in point: his idea of suitable bedtime reading is John Hersey's <i>Hiroshima</i>.)</p><p> The book is also, perhaps less successfully, about being young and hip and out to conquer the world (in an ironic, media-savvy, Gen-X way, naturally). In the early '90s, Eggers was one of the founders of the very funny <i>Might Magazine</i>, and he spends a fair amount of time here on <i>Might</i>, the hipster culture of San Francisco's South Park, and his own efforts to get on to MTV's <i>Real World</i>. This sort of thing doesn't age very well--but then, Eggers knows that. There's no criticism you can come up with that he hasn't put into <i>A.H.W.O.S.G.</i> already. "The book thereafter is kind of uneven," he tells us regarding the contents after page 109, and while that's true, it's still uneven in a way that is funny and heartfelt and <i>interesting</i>. </p><p> All this self-consciousness could have become unbearably arch. It's a testament to Eggers's skill as a writer--and to the heartbreaking particulars of his story--that it doesn't. Currently the editor of the footnote-and-marginalia-intensive journal <i>McSweeney's</i> (the last issue featured an entire story by David Foster Wallace printed tinily on its spine), Eggers comes from the most media-saturated generation in history--so much so that he can't feel an emotion without the sense that it's already been felt <i>for</i> him. What may seem like postmodern noodling is really just Eggers writing about pain in the only honest way available to him. Oddly enough, the effect is one of complete sincerity, and--especially in its concluding pages--this memoir as metafiction is affecting beyond all rational explanation. <i>--Mary Park</i></p>''')
    book17 = Book(name='Steppenwolf', slug='steppenwolf', author='Herman Hesse', owner=seymour, date_added=randomDate(), description=u'''<i>Steppenwolf</i> is a poetical self-portrait of a man who felt himself to be half-human and half-wolf. This Faust-like and magical story is evidence of Hesse's searching philosophy and extraordinary sense of humanity as he tells of the humanization of a middle-aged misanthrope. Yet this novel can also be seen as a plea for rigorous self-examination and an indictment of the intellectual hypocrisy of the period. As Hesse himself remarked, "Of all my books <i>Steppenwolf</i> is the one that was more often and more violently misunderstood than any other".''')
    book18 = Book(name='The Plague', slug='the-plague', author='Albert Camus', owner=seymour, date_added=randomDate(), description=u'''A gripping tale of human unrelieved horror, of survival and resilience, and of the ways in which humankind confronts death, The Plague is at once a masterfully crafted novel, eloquently understated and epic in scope, and a parable of ageless moral resonance, profoundly relevant to our times. In Oran, a coastal town in North Africa, the plague begins as a series of portents, unheeded by the people. It gradually becomes a omnipresent reality, obliterating all traces of the past and driving its victims to almost unearthly extremes of suffering, madness, and compassion.''')
    book19 = Book(name='The Autograph Man', slug='the-autograph-man', author='Zadie Smith', owner=booboo, date_added=randomDate(), description=u'''Alex-Li Tandem sells autographs. His business is to hunt for names on paper, collect them, sell them, and occasionally fake them—all to give the people what they want: a little piece of Fame. But what does Alex want? Only the return of his father, the end of religion, something for his headache, three different girls, infinite grace, and the rare autograph of forties movie actress Kitty Alexander. With fries.<br /><br /><b>The Autograph Man</b> is a deeply funny existential tour around the hollow trappings of modernity: celebrity, cinema, and the ugly triumph of symbol over experience. It offers further proof that Zadie Smith is one of the most staggeringly talented writers of her generation.''')
    book20 = Book(name='The Corrections', slug='the-corrections', author='Jonathan Franzen', owner=booboo, date_added=randomDate(), description=u'''The Lamberts - Enid and Alfred and their three grown-up children - are a troubled family living in a troubled age. Alfred is ill and as his condition worsens the whole family must face the failures, secrets and long-buried hurts that haunt them if they are to make the corrections that each desperately needs. Stretching from the Midwest in the mid-century to Wall Street and Eastern Europe in the age of globalised greed, The Corrections brings an old-time America of freight trains and civic duty into wild collision with the era of home surveillance, hands-off parenting, do-it-yourself mental healthcare, and New Economy millionaires. It announces Jonathan Franzen as one of the most brilliant interpreters of American society and the American soul.''')

    session.add(book1)
    session.add(book2)
    session.add(book3)
    session.add(book4)
    session.add(book5)
    session.add(book6)
    session.add(book7)
    session.add(book8)
    session.add(book9)
    session.add(book10)
    session.add(book11)
    session.add(book12)
    session.add(book13)
    session.add(book14)
    session.add(book15)
    session.add(book16)
    session.add(book17)
    session.add(book18)
    session.add(book19)
    session.add(book20)
    session.commit()
